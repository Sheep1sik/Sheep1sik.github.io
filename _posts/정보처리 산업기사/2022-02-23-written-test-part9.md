---
title:  "[ 필기 ] 교착상태 (DeadLock) " 

categories:
  - Data processing
tags:
  - [교착상태, 정보처리산업기사, 자격증]

toc: true
toc_sticky: true

date: 2022-02-23
last_modified_at: 2022-02-23
---
강의를 듣고 정리한 필기입니다. 😀 지식 공유보단 개인적인 복습을 목적으로 포스팅하였습니다.

---
## 1. 교착상태
	
### 1-1 교착상태의 정의
	복수의 프로세스(Process)가 가능하지 못한 상태를 무한정 기다리고 있는 상태를 말한다.
	두 개 이상의 프로세스가 하나의 자원을 공유하며 사용하고 있을 때 서로 사용할 자원을 요구하지만 요구는 영원히 들어줄 수 없는 상태를 말한다.

### 1-2 교착상태가 발생할 필요 충분 조건 4가지
	
#### 1-2-1 상호 배제 (Mutual Exclusion)
	프로세스들은 필요로 하는 자원에 대해 베타적인 통제권을 갖는다.
	즉, 임계구역을 두 개 이상의 프로세스가 동시에 접근하지 못하도록 하는 과정에서 발생할 수 밖에 없다.

#### 1-2-2 비 선점 (Non Preemption)
	프로세스가 소유하고 있는 자원은 다른 프로세스에 의해 선점될 수 없다.
	즉, 하나의 프로세스가 공유 자원을 사용하는 중에 중단되었을 때, 중단된 프로세스를 선점할 수 없기 때문에 발생할 수 밖에 없다.

#### 1-2-3 점유와 대기 (Hold & Wait)
	프로세스는 할당된 자원을 가진 상태에서 다른 자원을 기다린다.
	점유한 프로세스, 대기하는 프로세스가 존재하는 한 교착 상태가 발생할 수 밖에 없다.

#### 1-2-4 환영 대기 (Circular Wait, 순환 대기)
	각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 가지고 있다.
	“환형 상태의 교착상태 예” 처럼 서로 물고 물리는 상황 때문에 발생할 수 밖에 없다

### 1-3 교착상태 해결 방안
	교착상태는 필요악이다. 운영체제에서 교착상태를 발생하지 않도록 할 수 있다.
	하지만 제한된 자원에서 여러개의 프로세스가 운영되는 상태에서는 당장 사용하지 않는 자원을 다른 프로세스가 사용하도록 해야 컴퓨터 시스템을 효율적으로 사용할 수 있다.
	따라서 교착상태를 인정하되 가능한 발생하지 않도록 피해가는 쪽으로 운영된다.
	
교착상태 해결 방안은 다음과 같다.
	
#### 1-3-1 교착상태 예방 (Prevention)
	교착상태가 발생하지 않도록 미리 차단시키는 방법으로 교착상태가 발생할 피요 충분 조건 4가지를 부정하는 것이다.

#### 필요 충분 조건 4가지 부정

##### 상호배제 부정
	상호 배제를 하지 않는 시스템으로 구축한다.
	공유 자원을 동시에 접근이 허용 되므로 컴퓨터 시스템의 신뢰성은 보장할 수 없다.
	
##### 비 선점 부정
	선점을 인정하는 것으로 언제든 실행 중인 프로세스나 공유자원을 중단하거나 빼앗을 수 있게 한다.
	교착상태 예방 방법으로 가장 현실적이고 실현 가능한 방식이다.
	
##### 점유와 대기 부정
	각 프로세스는 한 번에 자신에게 필요한 모든 자원을 요구해야 하며, 이 요구가 만족되지 않으면 작업을 진행할 수 없다.
	어떤 자원을 갖고 있는 프로세스가 더 이상 요구가 수용되지 않으면 원래 갖고 있던 자원을 일단 반납하고 필요하다면 다시 그 자원이나 다른 자원을 요구해야 한다.

##### 환영 대기 부정
	환영 상태를 선형 대기 상태로 변환 하는 것으로 모든 자원들을 선형 순서(Linear order)로 분류한다.
	프로세스는 자신이 가지고 있는 자원의 앞 또는 뒤의 순서에 있는 자원들을 자유롭게 요청하게 하지 못하게 한다.
	모든 프로세스에 각 자원 유형별로 할당 순서를 부여한다.
	즉, 만일 한 프로세스가 주어진 유형의 자원을 할당 받았으면 그 프로세스는 순서에 따라 나중에 위치하는 유형의 자원만을 요구할 수 있게 한다.

#### 1-3-2 교착상채 회피 (Avoidance)
	프로세스가 자원을 요구할 때 시스템이 안전 상태를 유지할 수 있는 프로세스의 자원 요구만을 할당하여 주는 방안으로 자원 분배를 교착상태가 발생하지 않는
	범위 내에서 하는 방안이다.
	교착 상태 회피 방안으로 사용하는 알고리즘에는 Dijkstra가 제안한 기법인 은행원(Banker’s) 알고리즘이 가장 대표적이다

#### 1-3-2-1은행원 알고리즘(Banker’s Algorithm)

	대출 업무를 보는 은행원과 교착상태를 피해가는 방법이 유사하여 개발된 기법이다.
	은행원은 적은 돈을 가지고 많은 사람들에게 대출해주고 그 이자를 받는 것이 목적이다.
	운영체제도 제한된 자원을 가지고 많은 프로세스에게 자원을 나눠주는 것이 목적이다.

<img width="452" alt="Pasted Graphic" src="https://user-images.githubusercontent.com/88019314/155255312-ea100ee6-b887-403f-b46e-8b44ea7bb346.png">
<br>

	은행원 : 운영체제
	고객 : 프로세스
	대출 금액 : 현재 사용중인 자원 수
	대출 한도 : 프로그램을 끝내기까지 총 필요한 자원 수
	총 보유금액 : 운영체제가 가지고 있는 총 자원 수
	현 보유액 : 분배해주고 남은 자원 수

    예시)
        1. 현재 은행에서 대출할 수 있는 보유 금액을 10억이라고 하자.
		2. 4명의 고객에게 다음과 같이 대출을 해줬다고 하면 현재 은행 잔고는 3억이다.
		   대출금액은 7억으로 이미 지급된 금액이고, 대출 한도는 고객이 대출할 수 있는 최대 금액이다.
		3. 은행 잔고가 3억이므로 고객 A에게는 추가 대출을 요구하더라도 그 요구를 수용할 수 없다.
		   만약 고객 A에게 2억이나 3억을 대출해주면 잔고가 1억 혹은 0원이 되어 불안한 상태가 된다.
		4. 불안한 상태에서 나머지 고객이 추가 대출을 요구하면 그 요구들을 수용하기가 어렵게 되고, 전체적인 은행 업무에 차질이 생길 것이다.
		5. 만약 고객 B가 3억을 요구한다면 그 요구는 적극 수용한다. 3억을 모두 대출하면 대출 한도를 모두 대출 해준 것이므로 바로 상환이 된다. 은행잔고가 4억으로 안정되는 것이다.
		   ( 실제 은행 업무에서는 상환 기간이 있지만 운영체제에서는 바로 상환되기 때문이다. ) 
			
#### 1-3-2-2 은행원 알고리즘(Banker’s Algorithm)의 특징

	Dijkstra가 제안한 기법이다.
	불안전 상태와 안전 상태로 구분한다.
	안전 상태에서는 교착상태가 발생하지 않는다.
	이 방법을 적용하기 위해서는 자원의 양이 일정하여야 한다.
	이 방법을 적용하기 위해서는 사용자의 수가 일정하여야 한다.
	모든 요구를 유한시간 안에 할당하는 것을 보장해야 한다.
	응답시간의 예측이 필요한 대화식 프로그램에는 적용할 수 없다.


### 1-3-3 교착상태 발견 (Detection)
	컴퓨터의 중단 원인이 교착상태인지 아니면 다른 이유인지를 파악하는 방안이다.
	자원들과 프로세스들을 인접행렬로 표현하여 파악한다.
	
### 1-3-4 교착상태 회복 (Recovery)
	교착상태를 회복하기 위해서는 교착상태가 발생한 프로세스들 중에 희생양을 정하는 일이다.
	희생양이 정해지면 다른 프로세스를 잠시 중단시키고 점유하고 있던 자원을 빼앗는 일이다.

	자원을 빼앗을 희생양을 정하는 기준은 다음과 같다.

		1. 우선순위가 낮은 프로세스의 자원을 선점하여 프로세스를 일시 중단시킨다.
		2. 처리된 진행 상태가 적은 프로세스의 자원을 선점하여 프로세스를 일시 중단 시킨다.
		3. 자원을 적게 사용하고 있는 프로세스의 자원을 선점하여 프로세스를 일시 중단 시킨다.
		
	자원을 빼앗아도 교착상태가 회복이 안 되면 교착상태가 발생하기 이전 상태로 복귀(Rollback) 하여 다시 실행하는 방법이다.
	복귀를 통한 방법으로 교착상태가 회복이 안 되면 프로세스를 제거하여 회복한다.

	프로세스를 제거(Kill)할 희생양을 정하는 기준은 다음과 같다.
		
		1. 우선순위가 낮은 프로세스를 선택하여 제거한다.
		2. 처리된 진행상태가 적은 프로세스를 선택하여 제거한다.
		3. 자원을 적게 사용하고 있는 프로세스를 선택하여 제거한다.
		4. 기아 상태나 문제가 있는 프로세스를 제거한다.
		5. 정상 수행이 불가능한 모든 프로세스를 제거하고 다시 시작한다.

				
***
<br>

    개인 공부 기록용 블로그입니다. 오류나 틀린 부분이 있을 경우 
    댓글 혹은 메일로 지적해주시면 감사하겠습니다! 😄

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}